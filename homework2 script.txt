Sub homework2()            For Each ws In Worksheets                Dim Tick As String                Dim Price_begining As Double                Dim Price_end As Double                Dim Year_Change As Double                Dim Percent_Change As Double                Dim Total As LongLong                Dim StartCol As Integer                Dim totalCol As Integer                        Dim Min As Double                        Dim Max As Double                        Dim MaxTotal As LongLong                        Dim minTick As String                        Dim maxTick As String                        Dim totalTick As String                        Min = 0                        Max = 0                        MaxTotal = 0                Dim Summary_Table_Row As Integer            Summary_Table_Row = 2                Dim TotalRow As LongLong                TotalRow = ws.Cells(1, 1).End(xlDown).Row                    totalCol = ws.Cells(1, Columns.Count).End(xlToLeft).Column                    StartCol = totalCol + 2                    ws.Cells(1, StartCol).Value = "Ticker"                    ws.Cells(1, StartCol + 1).Value = "Yearly Change"                    ws.Cells(1, StartCol + 2).Value = "Percent Change"                     ws.Cells(1, StartCol + 3).Value = "Total Stock Volume"            For i = 1 To TotalRow                    If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then                                            If i = 1 Then                                        Price_begining = ws.Cells(i + 1, 3).Value                                                    ElseIf ws.Cells(i + 1, 1).Value <> "" Then                                    Tick = ws.Cells(i, 1).Value                                        ws.Cells(Summary_Table_Row, StartCol).Value = Tick                                        Price_end = ws.Cells(i, 6).Value                                        Year_Change = Price_end - Price_begining                                        If Price_begining = 0 Or Year_Change = 0 Then                                            Percent_Change = 0                                            Else                        Percent_Change = (Year_Change / Price_begining)                                        End If                                        ws.Cells(Summary_Table_Row, StartCol + 1).Value = Year_Change                                                    If Year_Change < 0 Then                                        ws.Cells(Summary_Table_Row, StartCol + 1).Interior.ColorIndex = 3                                 Else                                        ws.Cells(Summary_Table_Row, StartCol + 1).Interior.ColorIndex = 4                                                        End If                                                            ws.Cells(Summary_Table_Row, StartCol + 2).Value = Percent_Change                                        ws.Cells(Summary_Table_Row, StartCol + 2).NumberFormat = "0.00%"                                        ws.Cells(Summary_Table_Row, StartCol + 3).Value = Total                                        Summary_Table_Row = Summary_Table_Row + 1                                        If Min > Percent_Change Then                        Min = Percent_Change                        minTick = Tick                    End If                    If Max < Percent_Change Then                        Max = Percent_Change                        maxTick = Tick                    End If                    If MaxTotal < Total Then                        MaxTotal = Total                        totalTick = Tick                    End If                                                                            Price_begining = ws.Cells(i + 1, 3).Value                                                    End If                                                  Else            Total = Total + ws.Cells(i, 7).Value                                                End If                       Next i                        ws.Cells(2, StartCol + 5).Value = "Greatest % Increase"            ws.Cells(3, StartCol + 5).Value = "Greatest % Decrease"            ws.Cells(4, StartCol + 5).Value = "Greatest Total Volume"            ws.Cells(1, StartCol + 6).Value = "Ticker"            ws.Cells(2, StartCol + 6).Value = maxTick            ws.Cells(3, StartCol + 6).Value = minTick            ws.Cells(4, StartCol + 6).Value = totalTick            ws.Cells(1, StartCol + 7).Value = "Value"            ws.Cells(2, StartCol + 7).Value = Max            ws.Cells(3, StartCol + 7).Value = Min            ws.Cells(4, StartCol + 7).Value = MaxTotal            ws.Cells(2, StartCol + 7).NumberFormat = "0.00%"            ws.Cells(3, StartCol + 7).NumberFormat = "0.00%"                Next ws        End Sub